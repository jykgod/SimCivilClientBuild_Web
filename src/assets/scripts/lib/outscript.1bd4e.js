var ECS,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}c((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[0,o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},__decorate=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},UIAnimationUtils=function(){function t(){}return t.ScaleIn=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=1),t.active=!0,t.scale=n,t.stopAllActions();var o=cc.scaleTo(.5,i).easing(cc.easeBackOut());if(void 0!=e&&null!=e){var r=cc.sequence(o,cc.callFunc(e));t.runAction(r)}else t.runAction(o)},t.ScaleOut=function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i=0),t.scale=n,t.stopAllActions();var o=cc.scaleTo(.5,i).easing(cc.easeBackIn()),r=cc.sequence(o,cc.callFunc(function(){t.active=!1,void 0!=e&&null!=e&&e()}));t.runAction(r)},t.MoveIn=function(t,e,n,i){void 0===n&&(n=cc.Vec2.ZERO),void 0===i&&(i=null),t.active=!0,null!=i&&(t.position=i),t.stopAllActions();var o=cc.moveTo(1,n).easing(cc.easeBackOut());if(void 0!=e&&null!=e){var r=cc.sequence(o,cc.callFunc(e));t.runAction(r)}else t.runAction(o)},t.MoveOut=function(t,e,n,i){void 0===n&&(n=cc.Vec2.ZERO),void 0===i&&(i=null),null!=i&&(t.position=i),t.stopAllActions();var o=cc.moveTo(1,n).easing(cc.easeBackIn()),r=cc.sequence(o,cc.callFunc(function(){t.active=!1,void 0!=e&&null!=e&&e()}));t.runAction(r)},t}();(function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},set:function(t){this._entities=t},enumerable:!0,configurable:!0}),t.prototype.Update=function(){this.InternalUpdate()},t}();t.ScriptBehaviourManager=e,Object.seal(e.prototype.Update)})(ECS||(ECS={})),window.ECS||(window.ECS={}),window.ECS.ScriptBehaviourManager=ECS.ScriptBehaviourManager,function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.InternalUpdate=function(){this.OnUpdate()},e.prototype.OnDestroy=function(){},e.prototype.OnStart=function(){},e}(t.ScriptBehaviourManager);t.ComponentSystem=e,Object.seal(e.prototype.InternalUpdate),t.inject=function(t){return function(e,n){void 0==e.ctypes&&(e.ctypes=new Array,e.cnames=new Array),e.ctypes.push(t),e.cnames.push(n)}}}(ECS||(ECS={})),window.ECS||(window.ECS={}),window.ECS.ComponentSystem=ECS.ComponentSystem,window.ECS.inject=ECS.inject,function(t){var e=function(){function t(){this._entitiIDTop=0,this._entities=new Array,this._components=new Array,this._entitisComponents=new Array}return t.prototype.addComponent=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(null==e||void 0==e||e>=this._entitiIDTop)Logger.error("\u627e\u4e0d\u5230\u5b9e\u4f53 id:"+e,"EntitisManager.addComponent");else for(var o=0;o<n.length;o++){void 0==n[o].typeID&&(n[o].typeID=t._componentTypeIdTop,this._components[t._componentTypeIdTop]=new Array,t._componentTypeIdTop++);var r=n[o].typeID,a=this._components[r],s=void 0;for(s=a.length-1;s>=0;s--){if(a[s]<e){a[s+1]=e;break}a[s+1]=a[s]}-1==s&&(a[0]=e);var c=new n[o];this._entitisComponents[e][n[o].typeID]=c}},t.prototype.addSharedComponent=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)void 0==t[n].instance&&(t[n].instance=new t[n])},t.prototype.CreateAEntity=function(){return this._entitisComponents[this._entitiIDTop]=new Array,this._entities[this._entities.length]=this._entitiIDTop,this._entitiIDTop++},t.prototype.removeComponent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i++)this._entitisComponents[t][e[i].typeID]=void 0},t.prototype.removeSharedComponent=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)componentDataType[n].instance=void 0},t.prototype.RemoveAEntity=function(t){for(var e=0;e<this._components.length;e++){var n=this._components[e],i=n.indexOf(t);i>=0&&n.splice(i,1)}var o=this._entities.indexOf(t);o>=0&&this._entities.splice(o,1),this._entitisComponents[t]=void 0},t.prototype.GetEntities=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(null==t||void 0==t||0==t.length)return this._entities;for(var n=new Array,i=new Array,o=0,r=0;r<t.length;r++){if(void 0==this._components[t[r].typeID]||null==this._components[t[r].typeID])return null;i[r]=0,o=Math.max(o,this._components[t[r].typeID][0])}for(;;){for(r=0;r<t.length;r++)for(;this._components[t[r].typeID][i[r]]<o;){if(i[r]++,i[r]>=this._components[t[r].typeID].length)return n;o=Math.max(o,this._components[t[r].typeID][i[r]])}var a=!0;for(r=0;r<t.length;r++)if(this._components[t[r].typeID][i[r]]<o){a=!1;break}1==a&&(n.push(o),o+=1)}return n},t.prototype.GetComponent=function(t,e){if(null!=this._entitisComponents[t]&&void 0!=this._entitisComponents[t])return this._entitisComponents[t][e.typeID];Logger.error("\u627e\u4e0d\u5230\u5b9e\u4f53 id:"+t,"EntitisManager.addComponent")},t._componentTypeIdTop=0,t}();t.EntitisManager=e}(ECS||(ECS={})),window.ECS||(window.ECS={}),window.ECS.EntitisManager=ECS.EntitisManager,function(t){var e=function(){function e(e){this._deltaTime=.1,this._lastUpdateTime=0,this._name=e,this._entitisManager=new t.EntitisManager,this._systems=new Array}return Object.defineProperty(e,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),e.CreateAWorld=function(t){return this.RemoveWorld(t),this._worlds[t]=new e(t),null==this._active&&(this._active=this._worlds[t]),this._worlds[t]},e.RemoveWorld=function(t){void 0!=this._worlds[t]&&(this._worlds[t]==this._active&&(this._active=null),this._worlds[t].destroy(),this._worlds[t]=void 0)},e.SetActive=function(t){this._active=this._worlds[t]},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EntitisManager",{get:function(){return this._entitisManager},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){for(;this._systems.length>0;)this._systems.pop().OnDestroy()},e.prototype.update=function(){if(!(TimeManager.Instance.realTimeSinceStartScene-this._lastUpdateTime<this._deltaTime)){this._lastUpdateTime=TimeManager.Instance.realTimeSinceStartScene;for(var t=0;t<this._systems.length;t++){var e=this._systems[t].ctypes;if(null!=e&&void 0!=e){var n=this._systems[t].cnames,i=(s=this._entitisManager).GetEntities.apply(s,e);this._systems[t].entities=i;for(var o=0;o<e.length;o++){var r=new Array;if(this._systems[t][n[o]]=r,null!=i)for(var a=0;a<i.length;a++)r.push(this._entitisManager.GetComponent(i[a],e[o]))}}this._systems[t].Update()}var s}},e.prototype.addSystem=function(t){var e=new t;e.OnStart(),this._systems.push(e)},e._worlds=new Array,e}();t.World=e,Object.seal(e.prototype.update),Object.seal(e.prototype.addSystem)}(ECS||(ECS={})),window.ECS||(window.ECS={}),window.ECS.World=ECS.World;var TimeManager=function(){function t(){this._realTimeSinceStartScene=0,this._loginServerTime=0,this._loginDateTime=new Date(0)}return Object.defineProperty(t.prototype,"realTimeSinceStartScene",{get:function(){return this._realTimeSinceStartScene},enumerable:!0,configurable:!0}),t.prototype.Init=function(){this._realTimeSinceStartScene=0},t.prototype.Update=function(t){this._realTimeSinceStartScene+=t},t.prototype.GetDateTime=function(){return new Date},t.prototype.SaveServerTime=function(t){0==this._loginServerTime&&(this._loginDateTime=new Date,this._loginServerTime=t)},t.prototype.GetCurrentServerTIme=function(){return Math.round(new Date-this._loginDateTime)+this._loginServerTime},t.Instance=new t,t}();(function(t){var e=function(){function t(){this.Reset()}return Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return 0==this._paused?TimeManager.Instance.realTimeSinceStartScene-this.startTime:TimeManager.Instance.realTimeSinceStartScene-this.lastPauseTime},enumerable:!0,configurable:!0}),t.prototype.Reset=function(){this._paused=!1,this.startTime=TimeManager.Instance.realTimeSinceStartScene},t.prototype.Pause=function(){1!=this._paused&&(this._paused=!0,this.lastPauseTime=TimeManager.Instance.realTimeSinceStartScene)},t.prototype.Resume=function(){0!=this._paused&&(this._paused=!1,this.lastPauseTime=0,this.startTime=this.startTime+TimeManager.Instance.realTimeSinceStartScene-this.lastPauseTime)},t}();t.Timer=e})(Tools||(Tools={})),function(t){var e=function(){function t(t){this.instance=t}return t.prototype.build=function(){return this.instance},t}();t.Builder=e}(Tools||(Tools={})),function(t){var e=function(){function e(){}return e.setNumber=function(t,e){cc.sys.localStorage.setItem(t,e.toString())},e.setString=function(t,e){cc.sys.localStorage.setItem(t,e)},e.setObject=function(t,e){cc.sys.localStorage.setItem(t,JSON.stringify(e))},e.getNumber=function(t,e){void 0===e&&(e=0);var n=cc.sys.localStorage.getItem(t);return null==n||void 0==n?e:+n},e.getString=function(t,e){void 0===e&&(e=null);var n=cc.sys.localStorage.getItem(t);return null==n||void 0==n?e:n},e.getObject=function(t,e){void 0===e&&(e=null);var n=cc.sys.localStorage.getItem(t);return null==n||void 0==n?e:JSON.parse(n)},e.loadStorageObject=function(n){var i=e.getObject(n);return null==i||void 0==i?null:(i.Key=t.LocalStorageBase.prototype.Key,i.Save=t.LocalStorageBase.prototype.Save,i)},e.saveStorageObject=function(t){t.Save()},e}();t.LocalStorageUtils=e}(Tools||(Tools={})),window.LocalStorageUtils=Tools.LocalStorageUtils,function(t){var e=function(){function e(){}return Object.defineProperty(e,"EnableLog",{get:function(){return this._enableLog},set:function(e){this._enableLog=e,t.LocalStorageUtils.setNumber("5_",e?1:0)},enumerable:!0,configurable:!0}),e.log=function(t,e){0!=this._enableLog&&(null!=e&&void 0!=e?console.log("["+e+"] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t+" "):console.log("[notag] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t))},e.warn=function(t,e){0!=this._enableLog&&(null!=e&&void 0!=e?console.warn("["+e+"] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t):console.warn("[notag] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t))},e.error=function(t,e){0!=this._enableLog&&(null!=e&&void 0!=e?console.error("["+e+"] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t):console.error("[notag] ["+TimeManager.Instance.realTimeSinceStartScene.toFixed(3)+"] "+t))},e.info=function(t){0!=this._enableLog&&console.info(t)},e._enableLog=1==t.LocalStorageUtils.getNumber("5_",0),e}();t.Logger=e}(Tools||(Tools={}));var FSM,NetWork,Logger=Tools.Logger;function RPC(t,e){return function(n,i,o){o.value=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return __awaiter(this,void 0,void 0,function(){var r,a,s;return __generator(this,function(c){switch(c.label){case 0:for(r=0;r<o.length;r++)"function"==typeof o[r]&&(o[r]=RpcClient.Instance.AddCallBack(n,o[r]));return a=RpcClient.Instance.GetSequence(),RpcClient.Instance.SendRpc(a,t,i,o),0!=e?[3,2]:[4,RpcClient.Instance.GetResponce(a)];case 1:return null==(s=c.sent())||void 0==s?[2,null]:(TimeManager.Instance.SaveServerTime(s.TimeStamp),null!=s.ReturnValue.$values&&void 0!=s.ReturnValue.$values?[2,s.ReturnValue.$values]:null!=s.ReturnValue.$value&&void 0!=s.ReturnValue.$value?[2,s.ReturnValue.$value]:[2,s.ReturnValue]);case 2:return[2]}})})}}}(function(t){var e=function(){function t(){this.statesMap=new Array,this.currentState=null,this.asyncChangingState=!1,this.timer=new Tools.Timer}return t.prototype.AddState=function(t){null==this.statesMap[t.stateType]||void 0==this.statesMap[t.stateType]?this.statesMap[t.stateType]=t:Tools.Logger.error("attemp to add a same State into the StateMachine. StateMatchine:"+name+" State:"+t.stateType)},t.GetBuilder=function(){return new n(new t)},t.prototype.ChangeState=function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];null!=this.statesMap[t]&&void 0!=this.statesMap[t]?this.asyncChangingState?Tools.Logger.error("attemp to change to the "+t+" when the stateMachine is changing with async method!","FSM"):(null!=this.currentState&&this.currentState.StateEnd(this.timer.time),this.currentState=this.statesMap[t],this.timer.Reset(),(e=this.currentState).StateEnter.apply(e,n)):Tools.Logger.error("attemp to change to the "+t+" which "+name+" not has!","FSM")},t.prototype.ChangeStateAsync=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return null==this.statesMap[t]||void 0==this.statesMap[t]?(Tools.Logger.error("attemp to change to the "+t+" which "+name+" not has!","FSM"),[2]):this.asyncChangingState?(Tools.Logger.error("attemp to change to the "+t+" when the stateMachine is changing with async method!","FSM"),[2]):(this.asyncChangingState=!0,null==this.currentState?[3,2]:[4,this.currentState.StateEnd(this.timer.time)]);case 1:i.sent(),i.label=2;case 2:return this.currentState=this.statesMap[t],this.timer.Reset(),[4,this.currentState.StateEnter(n)];case 3:return i.sent(),this.asyncChangingState=!1,void 0!=e&&e(),[2]}})})},t.prototype.Update=function(){null!=this.currentState&&void 0!=this.currentState.StateUpdate&&!this.timer.paused&&!this.asyncChangingState&&this.currentState.StateUpdate(this.timer.time)},t.prototype.Pause=function(){this.timer.Pause()},t.prototype.Resume=function(){this.timer.Resume()},t.NONE={stateType:-1,StateEnter:function(){},StateEnd:function(t){}},t}();t.StateMachine=e;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.AddState=function(t){return this.instance.AddState(t),this},e}(Tools.Builder)})(FSM||(FSM={})),function(t){var e,n=function(){function t(t,n){if(this.sesionState=e.DISCONNECTED,null!=t&&void 0!=t){var i=this;this.ws=new WebSocket("ws://"+n),this.name=t,this.sesionState=e.CONNECTING,this.ws.onopen=function(t){Tools.Logger.log("connect",i.name),i.sesionState=e.CONNECTED,void 0!=i.OnConnect&&i.OnConnect(t)},this.ws.onclose=function(t){Tools.Logger.log("disconnect",i.name),i.sesionState=e.DISCONNECTED,void 0!=i.OnDisConnect&&i.OnDisConnect(t)},this.ws.onmessage=function(t){void 0!=i.OnGetMessage&&i.OnGetMessage(t)},this.ws.onerror=function(t){Tools.Logger.error("error:"+t.error,i.name),void 0!=i.OnError&&i.OnError(t)}}else Tools.Logger.error("session name can't be null or undefined")}return Object.defineProperty(t.prototype,"state",{get:function(){return this.sesionState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this.sesionState==e.CONNECTED},enumerable:!0,configurable:!0}),t.prototype.Close=function(t,n){this.sesionState!=e.DISCONNECTING&&this.sesionState!=e.DISCONNECTED&&(Logger.log("Try close",this.name),this.sesionState=e.DISCONNECTING,this.ws.close(t,n))},t.prototype.SendMessage=function(t){this.ws.send(t)},t}();t.SeverSession=n,function(t){t[t.CONNECTED=0]="CONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.DISCONNECTED=2]="DISCONNECTED",t[t.DISCONNECTING=3]="DISCONNECTING"}(e=t.SessionState||(t.SessionState={}))}(NetWork||(NetWork={})),function(t){(function(t){(function(t){var e=function(){return function(){}}();t.RpcCallback=e})(t.Callback||(t.Callback={}))})(t.Rpc||(t.Rpc={}))}(SimCivil||(SimCivil={}));var SimCivil,Tools,RpcClient=function(){function t(){this._session=null,this._sequence=0,this.resultQueue=new Array,this.promiseQueue=new Array,this.callbackQueue=new Array,this.callbackTargetQueue=new Array,this.timeOut=5}return Object.defineProperty(t.prototype,"session",{get:function(){return this._session},enumerable:!0,configurable:!0}),t.prototype.Init=function(t,e,n){var i=this;this._session=new NetWork.SeverSession("RPC",t),this._session.OnGetMessage=function(t){return i.GetMessage(t)},this._session.OnConnect=function(t){return e(t)},this._session.OnError=function(t){return n(t)}},t.prototype.GetMessage=function(t){var e=this,n=new FileReader;n.readAsText(t.data,"utf-8"),n.onload=function(t){var i,o=JSON.parse(n.result);if(-1!=o.$type.indexOf("SimCivil.Rpc.RpcResponse")){var r=JSON.parse(n.result);e.resultQueue[r.Sequence]=r,void 0!=e.promiseQueue[r.Sequence]&&null!=e.promiseQueue[r.Sequence]&&e.promiseQueue[r.Sequence]()}if(-1!=o.$type.indexOf("SimCivil.Rpc.Callback.RpcCallback")){r=JSON.parse(n.result);void 0!=e.callbackQueue[r.CallbackId]&&null!=e.callbackQueue[r.CallbackId]&&(null!=r.Parameters&&void 0!=r.Parameters?(i=e.callbackQueue[r.CallbackId]).call.apply(i,[e.callbackTargetQueue[r.CallbackId]].concat(r.Parameters)):e.callbackQueue[r.CallbackId].call(e.callbackTargetQueue[r.CallbackId]))}}},t.prototype.GetSequence=function(){return this._sequence++},t.prototype.AddCallBack=function(t,e){return this.callbackQueue.push(e),this.callbackTargetQueue.push(t),this.callbackQueue.length-1},t.prototype.GetResponce=function(t){return __awaiter(this,void 0,void 0,function(){var e,n=this;return __generator(this,function(i){switch(i.label){case 0:return[4,new Promise(function(e,i){n.promiseQueue[t]=e,setTimeout(function(){i("timeout in "+n.timeOut+" seconds.")},1e3*n.timeOut)}).catch(function(){Tools.Logger.log("TimeOut","RPC")})];case 1:return i.sent(),e=this.resultQueue[t],this.resultQueue[t]=null,[2,e]}})})},t.prototype.SendRpc=function(t,e,n,i){var o={$type:"SimCivil.Rpc.RpcRequest, SimCivil.Rpc",ServiceName:e,MethodName:n,Arguments:i,Sequence:t,TimeStamp:TimeManager.Instance.GetCurrentServerTIme()};Tools.Logger.log(JSON.stringify(o),"RPC"),this.session.SendMessage(this.stringToByte(JSON.stringify(o)))},t.prototype.stringToByte=function(t){var e,n,i=new Array;e=t.length;for(var o=0;o<e;o++)(n=t.charCodeAt(o))>=65536&&n<=1114111?(i.push(n>>18&7|240),i.push(n>>12&63|128),i.push(n>>6&63|128),i.push(63&n|128)):n>=2048&&n<=65535?(i.push(n>>12&15|224),i.push(n>>6&63|128),i.push(63&n|128)):n>=128&&n<=2047?(i.push(n>>6&31|192),i.push(63&n|128)):i.push(255&n);for(var r=new ArrayBuffer(i.length),a=new Uint8Array(r),s=(o=0,t.length);o<s;o++)a[o]=i[o];return r},t.prototype.Disconnect=function(){this._session.Close()},t.Instance=new t,t}();(function(t){(function(t){var e=function(){return function(){}}();t.RpcResponse=e})(t.Rpc||(t.Rpc={}))})(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){return function(){this.$type="SimCivil.Contract.CreateRoleOption, SimCivil.Contract",this.Name=null,this.Gender=null,this.Race=null}}();t.CreateRoleOption=e})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){return function(){this.$type="SimCivil.Contract.EntityInspection, SimCivil.Contract",this.EntityId="00000000-0000-0000-0000-000000000000",this.TimeStamp=0,this.ObserverId="00000000-0000-0000-0000-000000000000",this.Values={}}}();t.EntityInspection=e;var n=function(){return function(){this.$type="SimCivil.Contract.EntityInspectionValue, SimCivil.Contract"}}();t.EntityInspectionValue=n})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){(function(t){t[t.male=0]="male",t[t.female=1]="female",t[t.other=2]="other",t[t.none=3]="none"})(t.Gender||(t.Gender={}))})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){function t(){}return t.LogIn=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},t.LogInAsync=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},t.LogOut=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.LogOutAsync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.GetToken=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.Register=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},__decorate([RPC("SimCivil.Contract.IAuth",!1)],t,"LogIn",null),__decorate([RPC("SimCivil.Contract.IAuth",!1)],t,"LogInAsync",null),__decorate([RPC("SimCivil.Contract.IAuth",!0)],t,"LogOut",null),__decorate([RPC("SimCivil.Contract.IAuth",!0)],t,"LogOutAsync",null),__decorate([RPC("SimCivil.Contract.IAuth",!1)],t,"GetToken",null),__decorate([RPC("SimCivil.Contract.IAuth",!1)],t,"Register",null),t}();t.IAuth=e})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){function t(){}return t.Move=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.Stop=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.MoveTo=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},__decorate([RPC("SimCivil.Contract.IPlayerController",!0)],t,"Move",null),__decorate([RPC("SimCivil.Contract.IPlayerController",!0)],t,"Stop",null),__decorate([RPC("SimCivil.Contract.IPlayerController",!0)],t,"MoveTo",null),t}();t.IPlayerController=e})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){function t(){}return t.CreateRole=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},t.GetRoleList=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,[]]})})},t.UseRole=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},t.ReleaseRole=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,!1]})})},__decorate([RPC("SimCivil.Contract.IRoleManager",!1)],t,"CreateRole",null),__decorate([RPC("SimCivil.Contract.IRoleManager",!1)],t,"GetRoleList",null),__decorate([RPC("SimCivil.Contract.IRoleManager",!1)],t,"UseRole",null),__decorate([RPC("SimCivil.Contract.IRoleManager",!1)],t,"ReleaseRole",null),t}();t.IRoleManager=e})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){function t(){this.$type="SimCivil.Contract.ViewChange, SimCivil.Contract",this.TickCount=0,this.TileChange=[],this.EntityChange=[],this.Events=[],this.Position=null,this.Speed=0}return t.prototype.ToString=function(){return null},t}();t.ViewChange=e;var n=function(){function t(){this.$type="SimCivil.Contract.ViewEvent, SimCivil.Contract",this.EventType=null,this.TargetEntityId="00000000-0000-0000-0000-000000000000"}return t.prototype.ToString=function(){return null},t}();t.ViewEvent=n;var i=function(){function t(){this.$type="SimCivil.Contract.EntityDto, SimCivil.Contract",this.Id="00000000-0000-0000-0000-000000000000",this.Name=null,this.Pos=null}return t.prototype.ToString=function(){return null},t}();t.EntityDto=i;var o=function(){return function(){this.$type="SimCivil.Contract.TileDto, SimCivil.Contract",this.Position=null,this.Terrain=0}}();t.TileDto=o,function(t){t[t.entityLeave=0]="entityLeave"}(t.ViewEventType||(t.ViewEventType={}));var r=function(){function t(){}return t.RegisterViewSync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.DeregisterViewSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.GetAtlas=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,[]]})})},__decorate([RPC("SimCivil.Contract.IViewSynchronizer",!0)],t,"RegisterViewSync",null),__decorate([RPC("SimCivil.Contract.IViewSynchronizer",!0)],t,"DeregisterViewSync",null),__decorate([RPC("SimCivil.Contract.IViewSynchronizer",!1)],t,"GetAtlas",null),t}();t.IViewSynchronizer=r})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){(function(t){t[t.human=0]="human"})(t.Race||(t.Race={}))})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){function t(){this.$type="SimCivil.Contract.RoleSummary, SimCivil.Contract",this.Id="00000000-0000-0000-0000-000000000000",this.Name=null,this.Gender=null,this.Race=null}return t.prototype.ToString=function(){return null},t}();t.RoleSummary=e})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){(function(t){var e=function(){return function(t){this.$type="System.ValueTuple`2[[System.Single, mscorlib],[System.Single, mscorlib]], System.ValueTuple",this.Item1=+t.Item1.toPrecision(10),this.Item2=+t.Item2.toPrecision(10)}}();t.ValueTupleFloat=e;var n=function(){return function(t){this.$type="System.ValueTuple`2[[System.Int32, mscorlib],[System.Int32, mscorlib]], System.ValueTuple",this.Item1=+Math.round(t.Item1),this.Item2=+Math.round(t.Item2)}}();t.ValueTupleInt32=n})(t.Contract||(t.Contract={}))}(SimCivil||(SimCivil={})),function(t){var e=function(){function t(t){this._count=0,this._compare=t,this._arr=new Array}return t.prototype.upTree=function(){for(var t=this._count-1,e=0,n=null;t>0&&(e=t-1>>1,this._compare(this._arr[t],this._arr[e]));)n=this._arr[e],this._arr[e]=this._arr[t],this._arr[t]=n,t=e},t.prototype.downTree=function(t){for(var e=0,n=0,i=0,o=null;t<this._count;){if((e=2*t+1)>=this._count)return;if(i=(n=2*t+2)>=this._count||this._compare(this._arr[e],this._arr[n])?e:n,!this._compare(this._arr[i],this._arr[t]))break;o=this._arr[i],this._arr[i]=this._arr[t],this._arr[t]=o,t=i}},t.prototype.Remove=function(t){for(var e=0;e<this._count;e++)if(this._arr[e]===t)return this._arr[e]=this._arr[this._count-1],this._count--,void this.downTree(e)},t.prototype.Push=function(t){this._arr[this._count]=t,this._count++,this.upTree()},t.prototype.Pop=function(){if(0==this._count)return null;var t=this._arr[0];return this._count--,this._arr[0]=this._arr[this._count],this.downTree(0),t},t.prototype.GetSortArray=function(){for(var t=new Array,e=0;this._count>0;)t[e]=this._arr[0],this._count--,this._arr[0]=this._arr[this._count],this.downTree(0),this._arr[this._count]=t[e],e++;this._count=e,e>>=1;for(var n=0;n<e;n++){var i=this._arr[n];this._arr[n]=this._arr[this._count-n-1],this._arr[this._count-n-1]=i}return t},t}();t.BinaryHeap=e}(Tools||(Tools={})),function(t){var e=function(){function e(t){this.key=t}return e.prototype.Key=function(){return this.key},e.prototype.Save=function(){t.LocalStorageUtils.setObject(this.key,this)},e}();t.LocalStorageBase=e}(Tools||(Tools={})),window.LocalStorageBase=Tools.LocalStorageBase,function(t){var e=function(){return function(t){this.next=null,this.data=t}}(),n=function(){function t(){this._count=0,this._count=0,this._first=this.trail=null}return Object.defineProperty(t.prototype,"first",{get:function(){return this._first.data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),t.prototype.Enqueue=function(t){0==this._count?this._first=this.trail=new e(t):(this.trail.next=new e(t),this.trail=this.trail.next),this._count++},t.prototype.Dequeue=function(){if(0==this._count)return null;this._count--;var t=this._first.data;return this._first=this._first.next,t},t}();t.Queue=n}(Tools||(Tools={}));